# WebAssembly

## 概念

+ `WebAssembly` 是一种新的编码方式, 可以在现代浏览器中运行
  - 它是一种低级的类似汇编语言 
  - 具有紧凑的二进制格式
  - 可以接近原生的性能运行
  - 并未C/C++, C#, Rust等语言提供一个编译目标, 以便它们可以在web上运行
  - 它也可以被设计为可以与JS共存, 允许两者一起工作

## 基本概念

### 机器码

+ 机器码是计算机可直接执行的语言
+ 汇编比较接近机器码

### 机器码与CPU架构

+ 不同的CPU架构(x64, x86, ARM)需要不同的机器码和汇编
+ 高级语言可以 "翻译" 成机器码, 以便在CPU上运行

### WebAssembly

+ WebAssembly并不是汇编语言, 它不针对特定的机器, 而是针对浏览器.
+ WebAssembly 是中间编译器目标

> SourceCode -> WASM -> (x64 | x86 | ARM)等机器码

## WASM 是什么样的?

+ 文本格式: `.wat`
+ 二进制格式: `.wasm`

## WASM 能做什么

+ 可以把编写的 C/C++, C#, Rust 等语言的代码编译成 WASM模块
+ 可以在 Web 应用中加载该模块, 并通过 JS 调用它
+ 它并不是为了替代JS, 而是与JS一起工作
+ 仍然需要 HTML 和 JS, 因为 WASM 无法访问平台 API, 例如DOM, WebGL等

## 工作模式

以C为例

> hello.c 通过编译器 EMSCRIPTEN编译 -> hello.wasm -> 结合 hello.js + hello.html 一起运行在浏览器中

## 优点

+ 快速、高效、可移植
  - 通过利用常见的硬件能力, WASM代码在不同平台上能够接近本地速度运行
+ 可读、可调式
  - WASM 是一门低阶语言, 但是它确实有一种人类可读的文本格式(其标准最终版本目前仍在编制), 允许通过手工来写代码, 看代码以及调试代码
+ 保持安全
  - WASM 被限制运行在一个安全的沙箱执行环境中。像其他网络代码一样, 它遵循浏览器的同源策略和授权策略
+ 不破坏网络
  - WASN 的设计原则是与其他网络技术和谐共处并保持向后兼容

## Rust Cli工具

`cargo-generate`

使用:
```
cargo install cargo-generate
```

## WASM 更适合高性能场景, 比如3d场景, 比如页游, 或者其他图片音视频的处理

> 增删改查使用wasm, 属于是脱裤子放屁

